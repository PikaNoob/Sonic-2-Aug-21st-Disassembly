name: Check bit-perfectness

on: [push, pull_request]

jobs:
  build:
    runs-on: windows-latest

    steps:

      - uses: actions/checkout@v3

      - name: Assemble
        run: .\build.bat

      - name: Check if its bit-perfect
        run: |
          if((Test-Path s2built.bin)) {
            (Get-Content s2built.bin | Compare-Object -ReferenceObject (Get-Content sonic2alpha.bin)) | ForEach-Object { exit 0 }
          } else {
            echo "s2built.bin does not exist, probably due to an assembly error"
            exit 1
          }
